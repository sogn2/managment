<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/schema/mybatis-3-mapper.dtd">


<mapper namespace="com.booking.app.dao.BookingMapper">

    <!--  고객정보 등록  -->
    <insert id="customerInsert" parameterType="CustomerDto">
        INSERT INTO customer (customerName,customerPhone) values (#{customerName},#{customerPhone});
    </insert>
    <!--  예약 등록  -->
    <insert id="bookingInsert" parameterType="BookingDto">
                INSERT INTO booking
                    (customerNumber,companyNumber,personnel,Requirements,reservationDate,visitStatus, createDate)
                VALUES
                    ((select max(customerNumber2) from customer), #{companyNumber}, #{personnel}, #{Requirements}, #{reservationDate}, #{visitStatus}, now());
    </insert>
<!--예약리스트 조회-->
    <select id="bookingList" resultType="hashmap" parameterType="map">
        select * from booking  a inner JOIN customer  b on a.customerNumber = b.customerNumber2

    </select>
<!--검색-->
    <select id="bookingSearch" resultType="map" parameterType="SearchConditionDto">
        select * from booking  a inner JOIN customer  b on a.customerNumber = b.customerNumber2

       where true  <!--  and  a.reservationDate <![CDATA[ <= ]]>  #{reservationDate}-->
           and b.customerName like concat('%',#{customerName},'%')
             <!--and b.customerPhone like concat(${customerPhone},"%")-->

</select>

</mapper>